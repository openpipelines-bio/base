name: nanoplot
description: |
  Run NanoPlot on nanopore-sequenced reads.
keywords: ["quality control", "qc", "fastq", "sequencing summary", "nanopore"]
links:
  repository: https://github.com/wdecoster/NanoPlot
  homepage: http://nanoplot.bioinf.be/
  documentation: https://nanoplot.bioinf.be/
references:
  doi: 10.1093/bioinformatics/btad311
license: MIT
argument_groups:
  - name: Inputs
    arguments:
      - name: --fastq
        type: file
        description: Data is in one or more default fastq file(s).
        example: read.fq
        direction: input
        multiple: true
        multiple_sep: " "
      - name: --fasta
        type: file
        description: Data is in one or more fasta file(s).
        example: read.fa
        direction: input
        multiple: true
        multiple_sep: " "
      - name: --fastq_rich
        type: file
        description: |
          Data is in one or more fastq file(s) generated by albacore or 
          MinKNOW with additional information concerning channel and time.
        example: read.fq
        direction: input
        multiple: true
        multiple_sep: " "
      - name: --fastq_minimal
        type: file
        description: |
          Data is in one or more fastq file(s) generated by albacore or MinKNOW with
          additional information concerning channel and time. Minimal data is extracted
          swiftly without elaborate checks.
        example: read.fq
        direction: input
        multiple: true
        multiple_sep: " "
      - name: --summary
        type: file
        description: |
          Data is in one or more summary file(s) generated by albacore or guppy.
        example: read.txt
        direction: input
        multiple: true
        multiple_sep: " "
      - name: --bam
        type: file
        description: Data is in one or more sorted bam file(s).
        example: read.bam
        direction: input
        multiple: true
        multiple_sep: " "
      - name: --ubam
        type: file
        description: Data is in one or more unmapped bam file(s).
        example: read.ubam
        direction: input
        multiple: true
        multiple_sep: " "
      - name: --cram
        type: file
        description: Data is in one or more sorted cram file(s).
        example: read.cram
        direction: input
        multiple: true
        multiple_sep: " "
      - name: --pickle
        type: file
        description: Data is a pickle file stored earlier.
        example: read.pkl
        direction: input
        multiple: true
        multiple_sep: " "
      - name: --feather
        alternatives: [--arrow]
        type: file
        description: Data is in one or more feather file(s).
        example: read.arrow
        direction: input
        multiple: true
        multiple_sep: " "
  - name: Outputs
    arguments:
      - name: --statsum
        type: file
        description: Statistical summary from NanoPlot.
        direction: output
        default: output/*.txt
      - name: --nanoplots
        type: file
        description: Plots generated by NanoPlot.
        direction: output
        default: output/*.png
      - name: --html
        type: file
        description: NanoPlot report and HTML files.
        direction: output
        default: output/*.html
      - name: --log
        type: file
        description: Output Log file.
        direction: output
        default: output/*.log
  - name: Options
    arguments:
      # - name: --threads
      #   alternatives: [-t]
      #   type: integer
      #   description: Set the allowed number of threads to be used by the script.
      #   example: 2
      - name: --verbose
        type: boolean_true
        description: Write log messages also to terminal
      - name: --store
        type: boolean_true
        description: Store the extracted data in a pickle file for future plotting.
        # direction: output
        # default: output/*.pickle
      - name: --raw
        type: boolean_true
        description: Store the extracted data in tab separated file.
      - name: --huge
        type: boolean_true
        description: Input data is one very large file.
      - name: --no_static
        type: boolean_false
        description: Do not make static (png) plots.
      - name: --prefix
        alternatives: [-p]
        type: string
        description: Specify an optional prefix to be used for the output files.
      - name: --tsv_stats
        type: boolean_true
        description: Output the stats file as a properly formatted TSV.
      - name: --only_report
        type: boolean_true
        description: Output only the report.
      - name: --info_in_report
        type: boolean_true
        description: Add NanoPlot run info in the report.
  - name: Filtering or transforming input
    arguments:
      - name: --maxlength
        type: integer
        description: Drop reads longer than length specified.
      - name: --minlength
        type: integer
        description: Drop reads shorter than length specified.
      - name: --drop_outliers
        type: boolean_false
        description: Drop outlier reads with extreme long length.
      - name: --downsample
        type: integer
        description: Reduce dataset to N reads by random sampling.
      - name: --loglength
        type: boolean_true
        description: Logarithmic scaling of lengths in plots.
      - name: --percentqual
        type: boolean_true
        description: Use qualities as theoretical percent identities.
      - name: --alength
        type: boolean_true
        description: Use aligned read lengths rather than sequenced length (bam mode). 
      - name: --minqual
        type: integer
        description: Drop reads with an average quality lower than specified.
      - name: --runtime_until
        type: integer
        description: Only take the N first hours of a run.
      - name: --readtype
        type: string
        description: |
          Which read type to extract information about from summary.
          Options are 1D, 2D, 1D2
      - name: --barcoded
        type: boolean_true
        description: Use if you want to split the summary file by barcode.
      - name: --no_supplementary
        type: boolean_false
        description: Use if you want to remove supplementary alignments.
  - name: Customizing plots
    arguments:
      - name: --color
        alternatives: [-c]
        type: string
        description: Specify a color for the plots, must be a valid matplotlib color.
      - name: --colormap
        alternatives: [-cm]
        type: string
        description: Specify a valid matplotlib colormap for the heatmap.
      - name: --format
        alternatives: [-f]
        type: string
        description: |
          Specify the output format of the plots.
          {eps,jpeg,jpg,pdf,pgf,png,ps,raw,rgba,svg,svgz,tif,tiff}
      - name: --plots
        type: string
        description: |
          Specify which bivariate plots have to be made.
          [{kde,hex,dot} ...]
      - name: --legacy
        type: string
        description: |
          Specify which bivariate plots have to be made (legacy mode).
          [{kde,dot,hex} ...]
      - name: --listcolors
        type: boolean_true
        description: List the colors which are available for plotting and exit.
      - name: --listcolormaps
        type: boolean_true
        description: List the colormaps which are available for plotting and exit.
      - name: --no_N50 
        type: boolean_false
        description: Hide the N50 mark in the read length histogram.
      - name: --N50 
        type: boolean_true
        description: Show the N50 mark in the read length histogram.
      - name: --title
        type: string
        description: Add a title to all plots, requires quoting if using spaces.
      - name: --font_scale
        type: double
        description: Scale the font of the plots by a factor.
      - name: --dpi
        type: integer
        description: Set the dpi for saving images.
      - name: --hide_stats
        type: boolean_false
        description: Not adding Pearson R stats in some bivariate plots.
# Arguments not taken into account:
#    -o, --outdir    Specify directory in which output has to be created.
resources:
  - type: bash_script
    path: script.sh
test_resources:
  - type: bash_script
    path: test.sh
  - type: file
    path: test_data
engines:
  - type: docker
    image: quay.io/biocontainers/nanoplot:1.42.0--pyhdfd78af_0
    setup:
      - type: docker
        run: |
          touch ./var/software_versions.txt && \
          version=$(NanoPlot --version) && \
          # version=$(docker run quay.io/biocontainers/nanoplot:1.42.0--pyhdfd78af_0 NanoPlot --version) && \
          echo "$version" > ./var/software_versions.txt
runners:
  - type: executable
  - type: nextflow